<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Thread System: metrics::histogram&lt; T, BucketCount &gt; Class Template Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Thread System
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d1/d82/namespacemetrics.html">metrics</a></li><li class="navelem"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">histogram</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../dd/d14/classmetrics_1_1histogram-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">metrics::histogram&lt; T, BucketCount &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Histogram metric - distribution of values.  
 <a href="../../d2/d1f/classmetrics_1_1histogram.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for metrics::histogram&lt; T, BucketCount &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d08/classmetrics_1_1histogram__inherit__graph.png" border="0" usemap="#ametrics_1_1histogram_3_01T_00_01BucketCount_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="ametrics_1_1histogram_3_01T_00_01BucketCount_01_4_inherit__map" id="ametrics_1_1histogram_3_01T_00_01BucketCount_01_4_inherit__map">
<area shape="rect" title="Histogram metric &#45; distribution of values." alt="" coords="9,199,180,573"/>
<area shape="rect" href="../../dd/d6a/classmetrics_1_1metric__interface.html" title="Base interface for all metric types." alt="" coords="5,5,184,151"/>
<area shape="poly" title=" " alt="" coords="97,164,97,198,92,198,92,164"/>
</map>
</div>
<div class="dynheader">
Collaboration diagram for metrics::histogram&lt; T, BucketCount &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d28/classmetrics_1_1histogram__coll__graph.png" border="0" usemap="#ametrics_1_1histogram_3_01T_00_01BucketCount_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="ametrics_1_1histogram_3_01T_00_01BucketCount_01_4_coll__map" id="ametrics_1_1histogram_3_01T_00_01BucketCount_01_4_coll__map">
<area shape="rect" title="Histogram metric &#45; distribution of values." alt="" coords="455,513,625,768"/>
<area shape="rect" href="../../dd/d6a/classmetrics_1_1metric__interface.html" title="Base interface for all metric types." alt="" coords="5,291,184,436"/>
<area shape="poly" title=" " alt="" coords="158,445,204,487,266,527,332,561,397,589,455,611,454,616,395,594,330,566,263,532,201,491,155,449"/>
<area shape="rect" title=" " alt="" coords="259,323,437,403"/>
<area shape="poly" title=" " alt="" coords="377,402,447,502,443,505,373,405"/>
<area shape="rect" href="../../d3/d19/structmetrics_1_1histogram_1_1bucket.html" title=" " alt="" coords="263,133,414,228"/>
<area shape="poly" title=" " alt="" coords="344,228,348,307,342,307,338,228"/>
<area shape="rect" title=" " alt="" coords="157,5,328,71"/>
<area shape="poly" title=" " alt="" coords="236,72,222,141,212,235,212,286,218,337,229,388,249,435,266,462,286,488,335,532,388,569,441,597,439,602,385,573,331,536,283,491,262,465,244,437,224,389,212,338,207,286,207,234,217,140,231,70"/>
<area shape="poly" title=" " alt="" coords="266,69,300,118,296,121,262,72"/>
<area shape="rect" title=" " alt="" coords="461,331,619,396"/>
<area shape="poly" title=" " alt="" coords="543,396,543,497,537,497,537,396"/>
<area shape="rect" title=" " alt="" coords="643,331,805,396"/>
<area shape="poly" title=" " alt="" coords="721,397,708,442,686,491,664,523,639,554,634,550,660,520,682,488,703,441,716,395"/>
<area shape="rect" title=" " alt="" coords="829,331,907,396"/>
<area shape="poly" title=" " alt="" coords="854,397,825,444,786,491,715,548,642,593,639,588,712,543,782,487,821,441,850,395"/>
<area shape="rect" title=" " alt="" coords="803,141,933,221"/>
<area shape="poly" title=" " alt="" coords="871,235,871,330,865,330,865,235"/>
<area shape="rect" title=" " alt="" coords="931,331,1066,396"/>
<area shape="poly" title=" " alt="" coords="983,398,950,445,929,470,904,491,841,533,773,567,704,595,642,616,640,611,703,590,770,562,838,528,901,487,925,466,946,442,979,395"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d19/structmetrics_1_1histogram_1_1bucket.html">bucket</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a028d2605e4ec40cedd49c203e10ac1dc" id="r_a028d2605e4ec40cedd49c203e10ac1dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#a028d2605e4ec40cedd49c203e10ac1dc">histogram</a> (std::string <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#a237d9bfdc9e18b2d46716319ad2b344b">name</a>, std::string desc, std::vector&lt; T &gt; boundaries={})</td></tr>
<tr class="separator:a028d2605e4ec40cedd49c203e10ac1dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c7671176857546e70cfea730a1d50c2" id="r_a9c7671176857546e70cfea730a1d50c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#a9c7671176857546e70cfea730a1d50c2">observe</a> (T value) noexcept</td></tr>
<tr class="memdesc:a9c7671176857546e70cfea730a1d50c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Record a value in the histogram.  <br /></td></tr>
<tr class="separator:a9c7671176857546e70cfea730a1d50c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c7cf3b5ba329923c5385726c9951b9f" id="r_a7c7cf3b5ba329923c5385726c9951b9f"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#a7c7cf3b5ba329923c5385726c9951b9f">percentile</a> (double p) const</td></tr>
<tr class="memdesc:a7c7cf3b5ba329923c5385726c9951b9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate percentile.  <br /></td></tr>
<tr class="separator:a7c7cf3b5ba329923c5385726c9951b9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b4f7b3fcc7152d9743ba08a9e516cbb" id="r_a3b4f7b3fcc7152d9743ba08a9e516cbb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d82/namespacemetrics.html#ac5d924b336106bc45dbacd030f3c4b1a">json</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#a3b4f7b3fcc7152d9743ba08a9e516cbb">to_json</a> () const override</td></tr>
<tr class="memdesc:a3b4f7b3fcc7152d9743ba08a9e516cbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert metric to JSON representation.  <br /></td></tr>
<tr class="separator:a3b4f7b3fcc7152d9743ba08a9e516cbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec5d19323785b98fb3835a8d55a9270c" id="r_aec5d19323785b98fb3835a8d55a9270c"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#aec5d19323785b98fb3835a8d55a9270c">type_name</a> () const override</td></tr>
<tr class="memdesc:aec5d19323785b98fb3835a8d55a9270c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get metric type name.  <br /></td></tr>
<tr class="separator:aec5d19323785b98fb3835a8d55a9270c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a237d9bfdc9e18b2d46716319ad2b344b" id="r_a237d9bfdc9e18b2d46716319ad2b344b"><td class="memItemLeft" align="right" valign="top">const std::string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#a237d9bfdc9e18b2d46716319ad2b344b">name</a> () const override</td></tr>
<tr class="memdesc:a237d9bfdc9e18b2d46716319ad2b344b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get metric name.  <br /></td></tr>
<tr class="separator:a237d9bfdc9e18b2d46716319ad2b344b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a568a373adbf327e0c2969b5a45c07646" id="r_a568a373adbf327e0c2969b5a45c07646"><td class="memItemLeft" align="right" valign="top">const std::string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#a568a373adbf327e0c2969b5a45c07646">description</a> () const override</td></tr>
<tr class="memdesc:a568a373adbf327e0c2969b5a45c07646"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get metric description.  <br /></td></tr>
<tr class="separator:a568a373adbf327e0c2969b5a45c07646"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classmetrics_1_1metric__interface"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classmetrics_1_1metric__interface')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../dd/d6a/classmetrics_1_1metric__interface.html">metrics::metric_interface</a></td></tr>
<tr class="memitem:ae3e89f39724fbfeed81214d09820a919 inherit pub_methods_classmetrics_1_1metric__interface" id="r_ae3e89f39724fbfeed81214d09820a919"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classmetrics_1_1metric__interface.html#ae3e89f39724fbfeed81214d09820a919">~metric_interface</a> ()=default</td></tr>
<tr class="separator:ae3e89f39724fbfeed81214d09820a919 inherit pub_methods_classmetrics_1_1metric__interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a18841b3a4c540ec5cfe6adf0f93104cb" id="r_a18841b3a4c540ec5cfe6adf0f93104cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#a18841b3a4c540ec5cfe6adf0f93104cb">generate_exponential_buckets</a> ()</td></tr>
<tr class="separator:a18841b3a4c540ec5cfe6adf0f93104cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c1e2b4722df93cdfcf8ae07682b3e0" id="r_aa0c1e2b4722df93cdfcf8ae07682b3e0"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#aa0c1e2b4722df93cdfcf8ae07682b3e0">find_bucket</a> (T value) const noexcept</td></tr>
<tr class="separator:aa0c1e2b4722df93cdfcf8ae07682b3e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ad11d483517148392dcbdaa93c9dd301c" id="r_ad11d483517148392dcbdaa93c9dd301c"><td class="memItemLeft" align="right" valign="top">std::array&lt; <a class="el" href="../../d3/d19/structmetrics_1_1histogram_1_1bucket.html">bucket</a>, BucketCount &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#ad11d483517148392dcbdaa93c9dd301c">buckets_</a></td></tr>
<tr class="separator:ad11d483517148392dcbdaa93c9dd301c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d6e124f4b50dd7197db6a5436a85e8f" id="r_a1d6e124f4b50dd7197db6a5436a85e8f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a></td></tr>
<tr class="separator:a1d6e124f4b50dd7197db6a5436a85e8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ec978b5c32270f581b7d951f10aee84" id="r_a6ec978b5c32270f581b7d951f10aee84"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; uint64_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#a6ec978b5c32270f581b7d951f10aee84">total_count_</a> {0}</td></tr>
<tr class="separator:a6ec978b5c32270f581b7d951f10aee84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70011fd70d1ab0dd46564683a0cbd180" id="r_a70011fd70d1ab0dd46564683a0cbd180"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#a70011fd70d1ab0dd46564683a0cbd180">total_sum_</a> {0}</td></tr>
<tr class="separator:a70011fd70d1ab0dd46564683a0cbd180"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3911727e5a5ea1e242956d9034353085" id="r_a3911727e5a5ea1e242956d9034353085"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#a3911727e5a5ea1e242956d9034353085">name_</a></td></tr>
<tr class="separator:a3911727e5a5ea1e242956d9034353085"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a9d4907eebf092b66cf5ae68d61b736" id="r_a8a9d4907eebf092b66cf5ae68d61b736"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#a8a9d4907eebf092b66cf5ae68d61b736">description_</a></td></tr>
<tr class="separator:a8a9d4907eebf092b66cf5ae68d61b736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a184567445f76b015df700f951f22c777" id="r_a184567445f76b015df700f951f22c777"><td class="memItemLeft" align="right" valign="top">std::shared_mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html#a184567445f76b015df700f951f22c777">boundaries_mutex_</a></td></tr>
<tr class="separator:a184567445f76b015df700f951f22c777"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename T = double, size_t BucketCount = 64&gt;<br />
class metrics::histogram&lt; T, BucketCount &gt;</div><p>Histogram metric - distribution of values. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Numeric type for values </td></tr>
    <tr><td class="paramname">BucketCount</td><td>Number of buckets for distribution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00195">195</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a028d2605e4ec40cedd49c203e10ac1dc" name="a028d2605e4ec40cedd49c203e10ac1dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a028d2605e4ec40cedd49c203e10ac1dc">&#9670;&#160;</a></span>histogram()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::histogram </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; T &gt;&#160;</td>
          <td class="paramname"><em>boundaries</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00211">211</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  212</span>                                        {})</div>
<div class="line"><span class="lineno">  213</span>        : <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a3911727e5a5ea1e242956d9034353085">name_</a>(std::move(<a class="code hl_function" href="../../d2/d1f/classmetrics_1_1histogram.html#a237d9bfdc9e18b2d46716319ad2b344b">name</a>))</div>
<div class="line"><span class="lineno">  214</span>        , <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a8a9d4907eebf092b66cf5ae68d61b736">description_</a>(std::move(desc))</div>
<div class="line"><span class="lineno">  215</span>        , <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>(std::move(boundaries)) {</div>
<div class="line"><span class="lineno">  216</span>        </div>
<div class="line"><span class="lineno">  217</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>.empty()) {</div>
<div class="line"><span class="lineno">  218</span>            <span class="comment">// Default exponential buckets: 0.001, 0.002, 0.004, ... seconds</span></div>
<div class="line"><span class="lineno">  219</span>            <a class="code hl_function" href="../../d2/d1f/classmetrics_1_1histogram.html#a18841b3a4c540ec5cfe6adf0f93104cb">generate_exponential_buckets</a>();</div>
<div class="line"><span class="lineno">  220</span>        }</div>
<div class="line"><span class="lineno">  221</span>        </div>
<div class="line"><span class="lineno">  222</span>        <span class="comment">// Ensure boundaries are sorted</span></div>
<div class="line"><span class="lineno">  223</span>        std::sort(<a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>.begin(), <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>.end());</div>
<div class="line"><span class="lineno">  224</span>    }</div>
<div class="ttc" id="aclassmetrics_1_1histogram_html_a18841b3a4c540ec5cfe6adf0f93104cb"><div class="ttname"><a href="../../d2/d1f/classmetrics_1_1histogram.html#a18841b3a4c540ec5cfe6adf0f93104cb">metrics::histogram::generate_exponential_buckets</a></div><div class="ttdeci">void generate_exponential_buckets()</div><div class="ttdef"><b>Definition</b> <a href="../../df/d4b/metric__types_8h_source.html#l00304">metric_types.h:304</a></div></div>
<div class="ttc" id="aclassmetrics_1_1histogram_html_a1d6e124f4b50dd7197db6a5436a85e8f"><div class="ttname"><a href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">metrics::histogram::bucket_boundaries_</a></div><div class="ttdeci">std::vector&lt; T &gt; bucket_boundaries_</div><div class="ttdef"><b>Definition</b> <a href="../../df/d4b/metric__types_8h_source.html#l00203">metric_types.h:203</a></div></div>
<div class="ttc" id="aclassmetrics_1_1histogram_html_a237d9bfdc9e18b2d46716319ad2b344b"><div class="ttname"><a href="../../d2/d1f/classmetrics_1_1histogram.html#a237d9bfdc9e18b2d46716319ad2b344b">metrics::histogram::name</a></div><div class="ttdeci">const std::string &amp; name() const override</div><div class="ttdoc">Get metric name.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d4b/metric__types_8h_source.html#l00300">metric_types.h:300</a></div></div>
<div class="ttc" id="aclassmetrics_1_1histogram_html_a3911727e5a5ea1e242956d9034353085"><div class="ttname"><a href="../../d2/d1f/classmetrics_1_1histogram.html#a3911727e5a5ea1e242956d9034353085">metrics::histogram::name_</a></div><div class="ttdeci">const std::string name_</div><div class="ttdef"><b>Definition</b> <a href="../../df/d4b/metric__types_8h_source.html#l00206">metric_types.h:206</a></div></div>
<div class="ttc" id="aclassmetrics_1_1histogram_html_a8a9d4907eebf092b66cf5ae68d61b736"><div class="ttname"><a href="../../d2/d1f/classmetrics_1_1histogram.html#a8a9d4907eebf092b66cf5ae68d61b736">metrics::histogram::description_</a></div><div class="ttdeci">const std::string description_</div><div class="ttdef"><b>Definition</b> <a href="../../df/d4b/metric__types_8h_source.html#l00207">metric_types.h:207</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a568a373adbf327e0c2969b5a45c07646" name="a568a373adbf327e0c2969b5a45c07646"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a568a373adbf327e0c2969b5a45c07646">&#9670;&#160;</a></span>description()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string &amp; <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::description </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get metric description. </p>
<dl class="section return"><dt>Returns</dt><dd>Metric description </dd></dl>

<p>Implements <a class="el" href="../../dd/d6a/classmetrics_1_1metric__interface.html#a3e489027da0ef157946a70f6335be192">metrics::metric_interface</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00301">301</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  301</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a8a9d4907eebf092b66cf5ae68d61b736">description_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa0c1e2b4722df93cdfcf8ae07682b3e0" name="aa0c1e2b4722df93cdfcf8ae07682b3e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0c1e2b4722df93cdfcf8ae07682b3e0">&#9670;&#160;</a></span>find_bucket()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::find_bucket </td>
          <td>(</td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00314">314</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  314</span>                                               {</div>
<div class="line"><span class="lineno">  315</span>        <span class="comment">// Binary search for efficiency</span></div>
<div class="line"><span class="lineno">  316</span>        <span class="keyword">auto</span> it = std::lower_bound(<a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>.begin(), </div>
<div class="line"><span class="lineno">  317</span>                                  <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>.end(), value);</div>
<div class="line"><span class="lineno">  318</span>        <span class="keywordflow">return</span> std::distance(<a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>.begin(), it);</div>
<div class="line"><span class="lineno">  319</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d1f/classmetrics_1_1histogram_aa0c1e2b4722df93cdfcf8ae07682b3e0_icgraph.png" border="0" usemap="#ad2/d1f/classmetrics_1_1histogram_aa0c1e2b4722df93cdfcf8ae07682b3e0_icgraph" alt=""/></div>
<map name="ad2/d1f/classmetrics_1_1histogram_aa0c1e2b4722df93cdfcf8ae07682b3e0_icgraph" id="ad2/d1f/classmetrics_1_1histogram_aa0c1e2b4722df93cdfcf8ae07682b3e0_icgraph">
<area shape="rect" title=" " alt="" coords="199,5,344,45"/>
<area shape="rect" href="../../d2/d1f/classmetrics_1_1histogram.html#a9c7671176857546e70cfea730a1d50c2" title="Record a value in the histogram." alt="" coords="5,5,151,45"/>
<area shape="poly" title=" " alt="" coords="185,28,151,28,151,23,185,23"/>
</map>
</div>

</div>
</div>
<a id="a18841b3a4c540ec5cfe6adf0f93104cb" name="a18841b3a4c540ec5cfe6adf0f93104cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18841b3a4c540ec5cfe6adf0f93104cb">&#9670;&#160;</a></span>generate_exponential_buckets()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::generate_exponential_buckets </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00304">304</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  304</span>                                        {</div>
<div class="line"><span class="lineno">  305</span>        <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>.clear();</div>
<div class="line"><span class="lineno">  306</span>        T value = 0.001;  <span class="comment">// Start at 1ms</span></div>
<div class="line"><span class="lineno">  307</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; std::min(<span class="keywordtype">size_t</span>(20), BucketCount - 1); ++i) {</div>
<div class="line"><span class="lineno">  308</span>            <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>.push_back(value);</div>
<div class="line"><span class="lineno">  309</span>            value *= 2;</div>
<div class="line"><span class="lineno">  310</span>        }</div>
<div class="line"><span class="lineno">  311</span>        <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>.push_back(std::numeric_limits&lt;T&gt;::max());</div>
<div class="line"><span class="lineno">  312</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a237d9bfdc9e18b2d46716319ad2b344b" name="a237d9bfdc9e18b2d46716319ad2b344b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a237d9bfdc9e18b2d46716319ad2b344b">&#9670;&#160;</a></span>name()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string &amp; <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get metric name. </p>
<dl class="section return"><dt>Returns</dt><dd>Metric name </dd></dl>

<p>Implements <a class="el" href="../../dd/d6a/classmetrics_1_1metric__interface.html#af5087029a6d1790e503e38742144b34e">metrics::metric_interface</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00300">300</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  300</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a3911727e5a5ea1e242956d9034353085">name_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c7671176857546e70cfea730a1d50c2" name="a9c7671176857546e70cfea730a1d50c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c7671176857546e70cfea730a1d50c2">&#9670;&#160;</a></span>observe()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::observe </td>
          <td>(</td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Record a value in the histogram. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>Value to record </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00230">230</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  230</span>                                   {</div>
<div class="line"><span class="lineno">  231</span>        <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a6ec978b5c32270f581b7d951f10aee84">total_count_</a>.fetch_add(1, std::memory_order_relaxed);</div>
<div class="line"><span class="lineno">  232</span>        <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a70011fd70d1ab0dd46564683a0cbd180">total_sum_</a>.fetch_add(value, std::memory_order_relaxed);</div>
<div class="line"><span class="lineno">  233</span>        </div>
<div class="line"><span class="lineno">  234</span>        <span class="comment">// Find appropriate bucket</span></div>
<div class="line"><span class="lineno">  235</span>        <span class="keywordtype">size_t</span> bucket_idx = <a class="code hl_function" href="../../d2/d1f/classmetrics_1_1histogram.html#aa0c1e2b4722df93cdfcf8ae07682b3e0">find_bucket</a>(value);</div>
<div class="line"><span class="lineno">  236</span>        <span class="keywordflow">if</span> (bucket_idx &lt; <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#ad11d483517148392dcbdaa93c9dd301c">buckets_</a>.size()) {</div>
<div class="line"><span class="lineno">  237</span>            <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#ad11d483517148392dcbdaa93c9dd301c">buckets_</a>[bucket_idx].count.fetch_add(1, std::memory_order_relaxed);</div>
<div class="line"><span class="lineno">  238</span>            <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#ad11d483517148392dcbdaa93c9dd301c">buckets_</a>[bucket_idx].sum.fetch_add(value, std::memory_order_relaxed);</div>
<div class="line"><span class="lineno">  239</span>        }</div>
<div class="line"><span class="lineno">  240</span>    }</div>
<div class="ttc" id="aclassmetrics_1_1histogram_html_a6ec978b5c32270f581b7d951f10aee84"><div class="ttname"><a href="../../d2/d1f/classmetrics_1_1histogram.html#a6ec978b5c32270f581b7d951f10aee84">metrics::histogram::total_count_</a></div><div class="ttdeci">std::atomic&lt; uint64_t &gt; total_count_</div><div class="ttdef"><b>Definition</b> <a href="../../df/d4b/metric__types_8h_source.html#l00204">metric_types.h:204</a></div></div>
<div class="ttc" id="aclassmetrics_1_1histogram_html_a70011fd70d1ab0dd46564683a0cbd180"><div class="ttname"><a href="../../d2/d1f/classmetrics_1_1histogram.html#a70011fd70d1ab0dd46564683a0cbd180">metrics::histogram::total_sum_</a></div><div class="ttdeci">std::atomic&lt; T &gt; total_sum_</div><div class="ttdef"><b>Definition</b> <a href="../../df/d4b/metric__types_8h_source.html#l00205">metric_types.h:205</a></div></div>
<div class="ttc" id="aclassmetrics_1_1histogram_html_aa0c1e2b4722df93cdfcf8ae07682b3e0"><div class="ttname"><a href="../../d2/d1f/classmetrics_1_1histogram.html#aa0c1e2b4722df93cdfcf8ae07682b3e0">metrics::histogram::find_bucket</a></div><div class="ttdeci">size_t find_bucket(T value) const noexcept</div><div class="ttdef"><b>Definition</b> <a href="../../df/d4b/metric__types_8h_source.html#l00314">metric_types.h:314</a></div></div>
<div class="ttc" id="aclassmetrics_1_1histogram_html_ad11d483517148392dcbdaa93c9dd301c"><div class="ttname"><a href="../../d2/d1f/classmetrics_1_1histogram.html#ad11d483517148392dcbdaa93c9dd301c">metrics::histogram::buckets_</a></div><div class="ttdeci">std::array&lt; bucket, BucketCount &gt; buckets_</div><div class="ttdef"><b>Definition</b> <a href="../../df/d4b/metric__types_8h_source.html#l00202">metric_types.h:202</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d1f/classmetrics_1_1histogram_a9c7671176857546e70cfea730a1d50c2_cgraph.png" border="0" usemap="#ad2/d1f/classmetrics_1_1histogram_a9c7671176857546e70cfea730a1d50c2_cgraph" alt=""/></div>
<map name="ad2/d1f/classmetrics_1_1histogram_a9c7671176857546e70cfea730a1d50c2_cgraph" id="ad2/d1f/classmetrics_1_1histogram_a9c7671176857546e70cfea730a1d50c2_cgraph">
<area shape="rect" title="Record a value in the histogram." alt="" coords="5,5,151,45"/>
<area shape="rect" href="../../d2/d1f/classmetrics_1_1histogram.html#aa0c1e2b4722df93cdfcf8ae07682b3e0" title=" " alt="" coords="199,5,344,45"/>
<area shape="poly" title=" " alt="" coords="151,23,184,23,184,28,151,28"/>
</map>
</div>

</div>
</div>
<a id="a7c7cf3b5ba329923c5385726c9951b9f" name="a7c7cf3b5ba329923c5385726c9951b9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c7cf3b5ba329923c5385726c9951b9f">&#9670;&#160;</a></span>percentile()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::percentile </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate percentile. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Percentile (0.0 to 1.0) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Estimated percentile value </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00247">247</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  247</span>                                 {</div>
<div class="line"><span class="lineno">  248</span>        std::shared_lock lock(<a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a184567445f76b015df700f951f22c777">boundaries_mutex_</a>);</div>
<div class="line"><span class="lineno">  249</span>        </div>
<div class="line"><span class="lineno">  250</span>        uint64_t total = <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a6ec978b5c32270f581b7d951f10aee84">total_count_</a>.load(std::memory_order_relaxed);</div>
<div class="line"><span class="lineno">  251</span>        <span class="keywordflow">if</span> (total == 0) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  252</span>        </div>
<div class="line"><span class="lineno">  253</span>        uint64_t target = <span class="keyword">static_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(total * p);</div>
<div class="line"><span class="lineno">  254</span>        uint64_t current = 0;</div>
<div class="line"><span class="lineno">  255</span>        </div>
<div class="line"><span class="lineno">  256</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>.size(); ++i) {</div>
<div class="line"><span class="lineno">  257</span>            current += <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#ad11d483517148392dcbdaa93c9dd301c">buckets_</a>[i].count.load(std::memory_order_relaxed);</div>
<div class="line"><span class="lineno">  258</span>            <span class="keywordflow">if</span> (current &gt;= target) {</div>
<div class="line"><span class="lineno">  259</span>                <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>[i];</div>
<div class="line"><span class="lineno">  260</span>            }</div>
<div class="line"><span class="lineno">  261</span>        }</div>
<div class="line"><span class="lineno">  262</span>        </div>
<div class="line"><span class="lineno">  263</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>.empty() ? 0 : <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>.back();</div>
<div class="line"><span class="lineno">  264</span>    }</div>
<div class="ttc" id="aclassmetrics_1_1histogram_html_a184567445f76b015df700f951f22c777"><div class="ttname"><a href="../../d2/d1f/classmetrics_1_1histogram.html#a184567445f76b015df700f951f22c777">metrics::histogram::boundaries_mutex_</a></div><div class="ttdeci">std::shared_mutex boundaries_mutex_</div><div class="ttdef"><b>Definition</b> <a href="../../df/d4b/metric__types_8h_source.html#l00208">metric_types.h:208</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d1f/classmetrics_1_1histogram_a7c7cf3b5ba329923c5385726c9951b9f_icgraph.png" border="0" usemap="#ad2/d1f/classmetrics_1_1histogram_a7c7cf3b5ba329923c5385726c9951b9f_icgraph" alt=""/></div>
<map name="ad2/d1f/classmetrics_1_1histogram_a7c7cf3b5ba329923c5385726c9951b9f_icgraph" id="ad2/d1f/classmetrics_1_1histogram_a7c7cf3b5ba329923c5385726c9951b9f_icgraph">
<area shape="rect" title="Calculate percentile." alt="" coords="199,5,344,45"/>
<area shape="rect" href="../../d2/d1f/classmetrics_1_1histogram.html#a3b4f7b3fcc7152d9743ba08a9e516cbb" title="Convert metric to JSON representation." alt="" coords="5,5,151,45"/>
<area shape="poly" title=" " alt="" coords="185,28,151,28,151,23,185,23"/>
</map>
</div>

</div>
</div>
<a id="a3b4f7b3fcc7152d9743ba08a9e516cbb" name="a3b4f7b3fcc7152d9743ba08a9e516cbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b4f7b3fcc7152d9743ba08a9e516cbb">&#9670;&#160;</a></span>to_json()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d82/namespacemetrics.html#ac5d924b336106bc45dbacd030f3c4b1a">json</a> <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::to_json </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert metric to JSON representation. </p>
<dl class="section return"><dt>Returns</dt><dd>JSON object containing metric data </dd></dl>

<p>Implements <a class="el" href="../../dd/d6a/classmetrics_1_1metric__interface.html#a43b273e9b90f31046e821a910d921ae5">metrics::metric_interface</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00266">266</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  266</span>                                  {</div>
<div class="line"><span class="lineno">  267</span>        std::shared_lock lock(<a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a184567445f76b015df700f951f22c777">boundaries_mutex_</a>);</div>
<div class="line"><span class="lineno">  268</span>        </div>
<div class="line"><span class="lineno">  269</span>        uint64_t total_count = <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a6ec978b5c32270f581b7d951f10aee84">total_count_</a>.load(std::memory_order_relaxed);</div>
<div class="line"><span class="lineno">  270</span>        T total_sum = <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a70011fd70d1ab0dd46564683a0cbd180">total_sum_</a>.load(std::memory_order_relaxed);</div>
<div class="line"><span class="lineno">  271</span>        </div>
<div class="line"><span class="lineno">  272</span>        <a class="code hl_typedef" href="../../de/d32/monitored__typed__thread__pool_8h.html#ab701e3ac61a85b337ec5c1abaad6742d">json</a> buckets_json = json::array();</div>
<div class="line"><span class="lineno">  273</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>.size(); ++i) {</div>
<div class="line"><span class="lineno">  274</span>            uint64_t count = <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#ad11d483517148392dcbdaa93c9dd301c">buckets_</a>[i].count.load(std::memory_order_relaxed);</div>
<div class="line"><span class="lineno">  275</span>            <span class="keywordflow">if</span> (count &gt; 0) {</div>
<div class="line"><span class="lineno">  276</span>                buckets_json.push_back({</div>
<div class="line"><span class="lineno">  277</span>                    {<span class="stringliteral">&quot;le&quot;</span>, <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a1d6e124f4b50dd7197db6a5436a85e8f">bucket_boundaries_</a>[i]},</div>
<div class="line"><span class="lineno">  278</span>                    {<span class="stringliteral">&quot;count&quot;</span>, count}</div>
<div class="line"><span class="lineno">  279</span>                });</div>
<div class="line"><span class="lineno">  280</span>            }</div>
<div class="line"><span class="lineno">  281</span>        }</div>
<div class="line"><span class="lineno">  282</span>        </div>
<div class="line"><span class="lineno">  283</span>        <span class="keywordflow">return</span> {</div>
<div class="line"><span class="lineno">  284</span>            {<span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;histogram&quot;</span>},</div>
<div class="line"><span class="lineno">  285</span>            {<span class="stringliteral">&quot;name&quot;</span>, <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a3911727e5a5ea1e242956d9034353085">name_</a>},</div>
<div class="line"><span class="lineno">  286</span>            {<span class="stringliteral">&quot;description&quot;</span>, <a class="code hl_variable" href="../../d2/d1f/classmetrics_1_1histogram.html#a8a9d4907eebf092b66cf5ae68d61b736">description_</a>},</div>
<div class="line"><span class="lineno">  287</span>            {<span class="stringliteral">&quot;count&quot;</span>, total_count},</div>
<div class="line"><span class="lineno">  288</span>            {<span class="stringliteral">&quot;sum&quot;</span>, total_sum},</div>
<div class="line"><span class="lineno">  289</span>            {<span class="stringliteral">&quot;mean&quot;</span>, total_count &gt; 0 ? total_sum / total_count : 0},</div>
<div class="line"><span class="lineno">  290</span>            {<span class="stringliteral">&quot;p50&quot;</span>, <a class="code hl_function" href="../../d2/d1f/classmetrics_1_1histogram.html#a7c7cf3b5ba329923c5385726c9951b9f">percentile</a>(0.50)},</div>
<div class="line"><span class="lineno">  291</span>            {<span class="stringliteral">&quot;p90&quot;</span>, <a class="code hl_function" href="../../d2/d1f/classmetrics_1_1histogram.html#a7c7cf3b5ba329923c5385726c9951b9f">percentile</a>(0.90)},</div>
<div class="line"><span class="lineno">  292</span>            {<span class="stringliteral">&quot;p95&quot;</span>, <a class="code hl_function" href="../../d2/d1f/classmetrics_1_1histogram.html#a7c7cf3b5ba329923c5385726c9951b9f">percentile</a>(0.95)},</div>
<div class="line"><span class="lineno">  293</span>            {<span class="stringliteral">&quot;p99&quot;</span>, <a class="code hl_function" href="../../d2/d1f/classmetrics_1_1histogram.html#a7c7cf3b5ba329923c5385726c9951b9f">percentile</a>(0.99)},</div>
<div class="line"><span class="lineno">  294</span>            {<span class="stringliteral">&quot;p999&quot;</span>, <a class="code hl_function" href="../../d2/d1f/classmetrics_1_1histogram.html#a7c7cf3b5ba329923c5385726c9951b9f">percentile</a>(0.999)},</div>
<div class="line"><span class="lineno">  295</span>            {<span class="stringliteral">&quot;buckets&quot;</span>, buckets_json}</div>
<div class="line"><span class="lineno">  296</span>        };</div>
<div class="line"><span class="lineno">  297</span>    }</div>
<div class="ttc" id="aclassmetrics_1_1histogram_html_a7c7cf3b5ba329923c5385726c9951b9f"><div class="ttname"><a href="../../d2/d1f/classmetrics_1_1histogram.html#a7c7cf3b5ba329923c5385726c9951b9f">metrics::histogram::percentile</a></div><div class="ttdeci">T percentile(double p) const</div><div class="ttdoc">Calculate percentile.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d4b/metric__types_8h_source.html#l00247">metric_types.h:247</a></div></div>
<div class="ttc" id="amonitored__typed__thread__pool_8h_html_ab701e3ac61a85b337ec5c1abaad6742d"><div class="ttname"><a href="../../de/d32/monitored__typed__thread__pool_8h.html#ab701e3ac61a85b337ec5c1abaad6742d">json</a></div><div class="ttdeci">nlohmann::json json</div><div class="ttdef"><b>Definition</b> <a href="../../de/d32/monitored__typed__thread__pool_8h_source.html#l00014">monitored_typed_thread_pool.h:14</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d1f/classmetrics_1_1histogram_a3b4f7b3fcc7152d9743ba08a9e516cbb_cgraph.png" border="0" usemap="#ad2/d1f/classmetrics_1_1histogram_a3b4f7b3fcc7152d9743ba08a9e516cbb_cgraph" alt=""/></div>
<map name="ad2/d1f/classmetrics_1_1histogram_a3b4f7b3fcc7152d9743ba08a9e516cbb_cgraph" id="ad2/d1f/classmetrics_1_1histogram_a3b4f7b3fcc7152d9743ba08a9e516cbb_cgraph">
<area shape="rect" title="Convert metric to JSON representation." alt="" coords="5,5,151,45"/>
<area shape="rect" href="../../d2/d1f/classmetrics_1_1histogram.html#a7c7cf3b5ba329923c5385726c9951b9f" title="Calculate percentile." alt="" coords="199,5,344,45"/>
<area shape="poly" title=" " alt="" coords="151,23,184,23,184,28,151,28"/>
</map>
</div>

</div>
</div>
<a id="aec5d19323785b98fb3835a8d55a9270c" name="aec5d19323785b98fb3835a8d55a9270c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec5d19323785b98fb3835a8d55a9270c">&#9670;&#160;</a></span>type_name()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::type_name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get metric type name. </p>
<dl class="section return"><dt>Returns</dt><dd>Type name as string </dd></dl>

<p>Implements <a class="el" href="../../dd/d6a/classmetrics_1_1metric__interface.html#a3e342d17e852e312cbf80ac6af323afb">metrics::metric_interface</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00299">299</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  299</span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;histogram&quot;</span>; }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a184567445f76b015df700f951f22c777" name="a184567445f76b015df700f951f22c777"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a184567445f76b015df700f951f22c777">&#9670;&#160;</a></span>boundaries_mutex_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_mutex <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::boundaries_mutex_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00208">208</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>

</div>
</div>
<a id="a1d6e124f4b50dd7197db6a5436a85e8f" name="a1d6e124f4b50dd7197db6a5436a85e8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d6e124f4b50dd7197db6a5436a85e8f">&#9670;&#160;</a></span>bucket_boundaries_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;T&gt; <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::bucket_boundaries_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00203">203</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>

</div>
</div>
<a id="ad11d483517148392dcbdaa93c9dd301c" name="ad11d483517148392dcbdaa93c9dd301c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad11d483517148392dcbdaa93c9dd301c">&#9670;&#160;</a></span>buckets_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::array&lt;<a class="el" href="../../d3/d19/structmetrics_1_1histogram_1_1bucket.html">bucket</a>, BucketCount&gt; <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::buckets_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00202">202</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>

</div>
</div>
<a id="a8a9d4907eebf092b66cf5ae68d61b736" name="a8a9d4907eebf092b66cf5ae68d61b736"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a9d4907eebf092b66cf5ae68d61b736">&#9670;&#160;</a></span>description_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::description_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00207">207</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>

</div>
</div>
<a id="a3911727e5a5ea1e242956d9034353085" name="a3911727e5a5ea1e242956d9034353085"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3911727e5a5ea1e242956d9034353085">&#9670;&#160;</a></span>name_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::name_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00206">206</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>

</div>
</div>
<a id="a6ec978b5c32270f581b7d951f10aee84" name="a6ec978b5c32270f581b7d951f10aee84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ec978b5c32270f581b7d951f10aee84">&#9670;&#160;</a></span>total_count_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic&lt;uint64_t&gt; <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::total_count_ {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00204">204</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  204</span>{0};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a70011fd70d1ab0dd46564683a0cbd180" name="a70011fd70d1ab0dd46564683a0cbd180"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70011fd70d1ab0dd46564683a0cbd180">&#9670;&#160;</a></span>total_sum_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = double, size_t BucketCount = 64&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic&lt;T&gt; <a class="el" href="../../d2/d1f/classmetrics_1_1histogram.html">metrics::histogram</a>&lt; T, BucketCount &gt;::total_sum_ {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d4b/metric__types_8h_source.html#l00205">205</a> of file <a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  205</span>{0};</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>sources/metrics/<a class="el" href="../../df/d4b/metric__types_8h_source.html">metric_types.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Jun 7 2025 19:15:29 for Thread System by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
